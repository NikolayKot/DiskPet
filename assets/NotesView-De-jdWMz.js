import{d as _,C as w,_ as C,c as m,a as n,t as N,o as p,b as A,r as c,u as b,e as k,B as D,f as y,g as h,w as g,h as M,i as B,j as v,T as O,s as V,k as I,F as S,l as E}from"./index-DF6YaFDJ.js";const q="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%209H17M9%201L9%2017'%20stroke='white'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c/svg%3e",L=_({name:"NoteCard",props:{note:{type:Object,required:!0}},emits:["delete"],setup(e,{emit:t}){return{CloseIcon:w,handleDelete:()=>{t("delete",e.note.id)}}}}),T={class:"note-card"},j={class:"note-card__title"},F={class:"note-card__content"},U={class:"note-card__footer"},R=["src"];function z(e,t,a,l,r,d){return p(),m("article",T,[n("h2",j,N(e.note.title),1),n("p",F,N(e.note.content),1),n("div",U,[n("button",{class:"note-card__delete",onClick:t[0]||(t[0]=(...s)=>e.handleDelete&&e.handleDelete(...s))},[n("img",{src:e.CloseIcon,alt:"Delete note"},null,8,R),t[1]||(t[1]=n("span",{class:"note-card__delete-text"},"Удалить",-1))])])])}const H=C(L,[["render",z],["__scopeId","data-v-c46962a0"]]),$=A("notes",()=>{const e=c([]),t=b(),a=k.create({baseURL:"https://dist.nd.ru",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(s=>{const o=t.token;return o&&(s.headers.Authorization=`Bearer ${o}`),s});const l=async()=>{try{const s=await a.get("/api/notes");e.value=s.data}catch(s){throw console.error("Ошибка при получении заметок:",s),s}};return{notes:e,fetchNotes:l,addNote:async s=>{try{const o=await a.post("/api/notes",s);return await l(),o.data}catch(o){throw console.error("Ошибка при добавлении заметки:",o),o}},deleteNote:async s=>{try{await a.delete(`/api/notes/${s}`),await l()}catch(o){throw console.error("Ошибка при удалении заметки:",o),o}}}}),G=_({name:"AddNoteModal",props:{isOpen:{type:Boolean,required:!0}},components:{BaseInput:D},emits:["close"],setup(e,{emit:t}){const a=$(),l=c(""),r=c(""),d=c(""),s=c(""),o=()=>{let i=!0;return d.value="",s.value="",l.value||(d.value="Название заметки не может быть пустым",i=!1),r.value||(s.value="Текст заметки не может быть пустым",i=!1),i},u=async()=>{if(o())try{await a.addNote({title:l.value,content:r.value}),l.value="",r.value="",t("close")}catch(i){console.error("Ошибка при добавлении заметки:",i)}},f=()=>{l.value="",r.value="",d.value="",s.value="",t("close")};return{title:l,content:r,titleError:d,contentError:s,handleClose:f,handleOutsideClick:i=>{i.target.classList.contains("modal-overlay")&&f()},handleSubmit:u,CloseIcon:w}}}),J={class:"modal"},K=["src"];function P(e,t,a,l,r,d){const s=h("BaseInput");return p(),y(O,{name:"modal"},{default:g(()=>[e.isOpen?(p(),m("div",{key:0,class:"modal-overlay",onClick:t[4]||(t[4]=(...o)=>e.handleOutsideClick&&e.handleOutsideClick(...o))},[n("div",J,[n("button",{class:"modal__close",onClick:t[0]||(t[0]=(...o)=>e.handleClose&&e.handleClose(...o))},[n("img",{src:e.CloseIcon,alt:"Close"},null,8,K)]),t[6]||(t[6]=n("h2",{class:"modal__title"},"Добавление заметки",-1)),n("form",{class:"modal__form",onSubmit:t[3]||(t[3]=B((...o)=>e.handleSubmit&&e.handleSubmit(...o),["prevent"]))},[v(s,{modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.title=o),label:"Название заметки",type:"name",placeholder:"Введите название",error:e.titleError,required:""},null,8,["modelValue","error"]),v(s,{modelValue:e.content,"onUpdate:modelValue":t[2]||(t[2]=o=>e.content=o),label:"Текст заметки",type:"textarea",placeholder:"Введите текст",error:e.contentError,required:""},null,8,["modelValue","error"]),t[5]||(t[5]=n("div",{class:"modal__bottom"},[n("button",{type:"submit",class:"modal__submit"},"Добавить заметку")],-1))],32)])])):M("",!0)]),_:1})}const Q=C(G,[["render",P],["__scopeId","data-v-662b1139"]]),W=_({name:"NotesView",components:{NoteCard:H,AddNoteModal:Q},setup(){const e=$(),{notes:t}=V(e),a=c(!1);I(async()=>{await e.fetchNotes()});const l=()=>{a.value=!0},r=()=>{a.value=!1};return{AddIcon:q,notes:t,isAddNoteModalOpen:a,handleOpenModal:l,handleCloseModal:r,handleDeleteNote:async o=>{try{await e.deleteNote(o)}catch(u){console.error("Ошибка при удалении заметки:",u)}},handleAddNote:async o=>{try{await e.addNote(o),r()}catch(u){console.error("Ошибка при добавлении заметки:",u)}}}}}),X={class:"notes"},Y={class:"notes__container"},Z={class:"notes__grid"},x=["src"];function ee(e,t,a,l,r,d){const s=h("NoteCard"),o=h("AddNoteModal");return p(),m("main",X,[n("div",Y,[n("div",Z,[(p(!0),m(S,null,E(e.notes,u=>(p(),y(s,{key:u.id,note:u,onDelete:e.handleDeleteNote},null,8,["note","onDelete"]))),128))]),n("button",{class:"notes__add-button",onClick:t[0]||(t[0]=(...u)=>e.handleOpenModal&&e.handleOpenModal(...u))},[n("img",{src:e.AddIcon,alt:"Add note"},null,8,x)])]),v(o,{"is-open":e.isAddNoteModalOpen,onClose:e.handleCloseModal,onAddNote:e.handleAddNote},null,8,["is-open","onClose","onAddNote"])])}const se=C(W,[["render",ee],["__scopeId","data-v-92baa8c2"]]);export{se as default};
